<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="sprintf()"/>
	<title>sprintf()</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>sprintf()</h1>

<p>The C library function <code>int sprintf(char *str, const char *format, ...)</code> sends formatted output to a string pointed to, by <i>str</i>.</p>

<h2>Declaration</h2>

<p>Following is the declaration for <code>sprintf()</code> function.</p>

<pre>int sprintf(char *str, const char *format, ...)</pre>

<h2>Parameters</h2>

<ul>
	<li><p>str − This is the pointer to an array of char elements where the resulting C string is stored.</p></li>

	<li><p>format − This is the String that contains the text to be written to buffer. It can optionally contain embedded format tags that are replaced by the values specified in subsequent additional arguments and formatted as requested. Format tags prototype: %[flags][width][.precision][length]specifier, as explained below −</p></li>
</ul>

<h2>Return Value</h2>

<p>If successful, the total number of characters written is returned excluding the null-character appended at the end of the string, otherwise a negative number is returned in case of failure.</p>

<h3>Example</h3>

<p>The following example shows the usage of <code>sprintf()</code> function.</p>

<pre>
#include &lt;stdio.h&gt;
#include &lt;math.h&gt;

int main () {
   char str[80];

   sprintf(str, "Value of Pi = %f", M_PI);
   puts(str);
   
   return 0;
}
</pre>

<p>Let us compile and run the above program, this will produce the following result −</p>

<pre>Value of Pi = 3.141593</pre>

<h2>Conversione numero a stringa</h2>

<p>Convertiamo due numeri in una stringa costituita da questi.</p>

<pre>
#include &lt;stdio.h&gt;
int main() {
   char str[20];    //create an empty string to store number
   int num1, num2;
   printf("Enter a number: ");
   scanf("%d", &num1);
   printf("Enter second number: ");
   scanf("%d", &num2);
   sprintf(str, "%d%d", num1, num2);
   printf("You enetered %s\n", str);
   return 0;
}
</pre>

<h1>snprintf()</h1>

<p>La funzione snprintf è nuova in C99 ed è largamente supportata, anche da fornitori che non dichiarano di essere conformi allo standard C99. Risulta di aiuto nella prevenzione dei buffer overflow, una ben nota forma di attacco da parte degli hacker. Il prototipo di <code>sprintf()</code> è</p>

<pre>
#include &lt;stdio.h&gt;
int snprintf( char * restrict dest, size_t n, const char * restrict format, ... );</pre>

<p>La vecchia funzione <code>sprintf</code> scrive in un buffer, man non sa quanto grande sia tale buffer. Semplicemente scrive quanto è necessario e ciò può danneggiare quanto è allocato dopo il buffer in memoria. Con la funzione <code>snprintf</code> del buffer è passata alla funzione, che non scriverà oltre la fine di quest'ultimo.  The snprintf() function is similar to printf() but writes its output as a string in the buffer referenced by the first pointer argument, <code>dest</code> , rather than to stdout.</p>

<p>Furthermore, the second argument, <i>n</i>, specifies the maximum number of characters that snprintf() may write to the buffer, including the terminating null character. If <i>n</i> is too small to accommodate the complete output string, then snprintf() writes only the first <i>n – 1</i> characters of the output, followed by a null character, and discards the rest. The return value is the number of characters (not counting the terminating null character) that would have been written if <i>n</i> had been large enough. Consequently, the output string has been written completely if and only if the function returns a non-negative value less than <i>n</i>. To obtain the length of the output string without storing it, you can set n equal to zero; in this case, sprintf() writes nothing to <i>dest</i>, which may be a null pointer.</p>

<p>Ciò preserverà l'integrità dei dati in memoria anche in presenza di un errore logico o di un errore nella dimensione del buffer nel programma. Evitando i buffer overflow, <code>snprintf</code> rende i programmi più facili da correggere in quanto un buffer overflow può provocare il fallimento di parti scorrelate del programma, rendendo difficile identificare il problema reale.</p>

<h2>Concatenate strings</h2>

<p>An application of this function is the concatenation of two strings.</p>

<pre>
	char user_name[50], file_name[54];
	scanf("%s", user_name);
	snprintf(file_name, sizeof file_name, "%s.dat", user_name);
</pre>

<section aria-label="End">
<a href="system.html">&#171;Thermodynamic Systems</a>
<a href="index.html">Index</a>
<a href="continuity.html">Definizione limite per funzioni operanti tra spazi metrici o normati &#187;</a>
</section>

</article>

</body>
</html>
