<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="gcc compiler"/>
	<title>gcc compiler</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>gcc compiler</h1>

<p>The code can’t actually do anything until it’s compiled into an executable binary file. The binary <code>a.out</code> ’s instructions are written in machine language, an elementary language the CPU can understand called <b>assambler code</b>. Compilers are designed to translate the language of C code into machine language for a variety of processor architectures. In this case, the processor is in a family that uses the x86 architecture. There are also Sparc processor architectures (used in Sun Workstations) and the PowerPC processor architecture (used in pre-Intel Macs). Each architecture has a different machine language, so the compiler acts as a middle ground—translating C code into
machine language for the target architecture.</p>
 
<p>A program usually consists of several separate parts, often developed by different people. For example, the “Hello, World!” program consists of the part we wrote plus parts of the C++ standard library. These separate parts (sometimes called translation units) must be compiled and the resulting object code files must be linked together to form an executable program. The program that links such parts together is (unsurprisingly) called a <i>linker</i>:</p>

<img src="img/compilationprocess.png" alg="compilation processes"/>

<p>The <i>gcc</i> command can range from simple to convoluted depending upon the operations that the user wishes to perform. At its simplest, you specify</p>

<pre>gcc [compilation-option] filename</pre>

<p>The compilation option will be one of <i>-c, -S</i> or <i>-E</I> where,</p>

<ul>
	<li><p><i>-c</i> performs compilation or assembly but no linking;</p></li>
	<li><p><i>-S</i> performs compilation but not assembly</p></li>
	<li><p><i>-E</i> stops after the preprocessing stage.</p></li>
	<li><p><i>-o</i>: specifies the <u>o</u>utput executable filename.</p></li>
	<li><p><i>-Wall</i>: prints "all" <u>W</u>arning messages.</p></li>
	<li><p><i>-g</i>: generates additional symbolic debug<span class="underline">g</span>ging information for use with <code>gdb</code> debugger.</li>
</ul>

<p>If no compilation option is given, then compilation performs preprocessing, compilation, linking, and assembly combined.</p> 

<p>By using <code>-c</code>, the output produced by the compiler is an object file (with a .o extension). You would use -c to create a library file that other programs might link to. By itself, the .o file is not executable but can only be used by the compiler to produce other compiled programs.</p>

<h2>More GCC Compiler Options</h2>

<p>A few commonly-used GCC compiler options are:</p>
<pre class="color-command">$ g++ <strong>-Wall -g -o Hello.exe</strong> Hello.cpp</pre>

<ul>

</ul>

<h5>Compile and Link Separately</h5>

<p>The above command <em>compile</em> the source file into object file and <code>link</code> with other object files and system libraries into executable in one step. You may separate compile and link in two steps as follows:</p>

<pre>// Compile-only with -c option</span>
&gt; <strong>g++ -c -Wall -g Hello.cpp</strong>
<span class="color-comment">// Link object file(s) into an executable</span>
&gt; <strong>g++ -g -o Hello.exe Hello.o</strong></pre>

<p>The options are:</p>
<ul>
<li><p>-c</code>: <u>C</u>ompile into object file "<code>Hello.o</code>". By default, the object file has the same name as the source file with extension of "<code>.o</code>" (there is no need to specify <code>-o</code> option). No linking with other object files or libraries.</li>
<li>Linking is performed when the input file are object files "<code>.o</code>" (instead of source file "<code>.cpp</code>" or "<code>.c</code>"). GCC uses a separate linker program (called <code>ld.exe</code>) to perform the linking.</li>
</ul>

<h3>Compile and Link Multiple Source Files</h3>

<p>Suppose that your program has two source files: <code>file1.cpp</code>, <code>file2.cpp</code>. You could compile all of them in a single command:</p>

<pre class="color-command">&gt; g<strong>++ -o myprog.exe file1.cpp file2.cpp</strong> </pre>

<p>However, we usually compile each of the source files separately into object file, and link them together in the later stage. In this case, changes in one file does not require re-compilation of the other files.</p>

<pre class="color-command">&gt; <strong>g++ -c file1.cpp</strong>
&gt; <strong>g++ -c file2.cpp</strong>
&gt; <strong>g++ -o myprog.exe file1.o file2.o</strong>
</pre>

<h2 id="pkg">pkg-config</h2>

<p>The <code>pkg-config</code> gives you command line switches, usually used for compilation and linking. For example if we want the name for the library GtkSourceView, having installed libgtksourceview-3.0-dev, we use</p>

<pre>dpkg -L libgtksourceview-3.0-dev | grep pkg</pre>

<p>The output is</p>

<pre>
/usr/lib/x86_64-linux-gnu/pkgconfig
/usr/lib/x86_64-linux-gnu/pkgconfig/gtksourceview-3.0.pc
</pre>

<p>remove the .pc extension and that is probably the name to be used with <i>pkgconfig --libs</i> inside the Makefile.</p>

<p>These are exactly the flags I need to compile using GSL and LibXML2. The <b>-l</b> flags reveal that GNU Scientific Library depends on a Basic Linear Algebra Subprograms (BLAS) library, and the GSL’s BLAS library depends on the standard math library. It seems that all the libraries are in the usual places, because there are no -L flags, but the -I flag indicates the location for LibXML2’s header files. <br> Back on the command line, when you surround a command by backticks, the shell replaces the command with its output. That is, when I type:</p>

<div class="eq">
<p>gcc `pkg-config --cflags --libs gsl libxml-2.0` -o specific specific.c</p>
</div>

<p>the compiler sees:</p>

<div class="eq">
<p>gcc -I/usr/include/libxml2 -lgsl -lgslcblas -lm -lxml2 -o specific specific.c</p>
</div>

<p>So <code>pkg-config</code> does a lot of the work for us, but it is not sufficiently standard that we can expect that everybody has it or that every library is registered with it. If you don’t have <i>pkg-config</i>, then you’ll have to do this sort of research yourself, by reading the manual for your library or searching your disk as we saw previously.</p>

<section aria-label="End">
<a href="system.html">&#171;Thermodynamic Systems</a>
<a href="index.html">Index</a>
<a href="makefile.html">Makefile &#187;</a>
</section>

</article>

</body>
</html>
