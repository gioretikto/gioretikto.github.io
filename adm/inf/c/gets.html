<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="description" content="The Unfortunate gets() Function"/>
    <title>The Unfortunate gets() Function</title>
    <link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
    <ul>
        <li><a class="navbar" href="../../index.php">Home</a></li>
        <li><a class="navbar" href="../../documentation.html">Documentation</a></li>
    </ul>
</nav>
      
<div class="content">

<h1>The Unfortunate gets() Function</h1>

<p>Recall that, when reading a string, <code>scanf()</code> and the %s specifier read just a single word. Often it’s useful if a program can read an entire line of input at a time instead of a single word. For many years, the <code>gets()</code> function has served that purpose. It’s a simple function, easy to use. It reads an entire line up through the newline character, discards the newline character, stores the remaining characters, adding a null character to create a C string. It’s often paired with <code>puts()</code>, which displays a string, adding a newline. Following an example.</p>

<pre>
/* getsputs.c -- using gets() and puts() */
#include &lt;stdio.h&gt;

#define STLEN <span class="number">87</span>
int main(void)
{
   char words[STLEN];
   <span class="function">puts</span>(<span class="string">"Enter a string, please."</span>);
   <span class="function">gets</span>(words);
   <span class="function">printf</span>(<span class="string">"Your string twice:\n"</span>);
   <span class="function">printf</span>(<span class="string">"%s\n"</span>, words);
   <span class="function">puts</span>(words);
   <span class="function">puts</span>(<span class="string">"Done."</span>);
   return <span class="number">0</span>;
}
</pre>

<p>So what’s the problem? The problem is that gets() doesn’t check to see if the input line actually fits into the array. Given that its only argument here is words, gets() can’t check. Recall that the name of an array is converted to the address of the first element. Thus gets() only knows where the array begins, not how many elements it has.</p>

<p>If the input string is too long, you get buffer overflow, meaning the excess characters overflow the designated target. The extra characters might just go into unused memory and cause no immediate problems, or they may overwrite other data in your program, but those certainly aren’t the only possibilities. Here’s a sample run for which STLEN was reset to 5 to make it easier to overflow the buffer:</p>

<pre>
Enter a string, please.
warning: this program uses gets(), which is unsafe.
I think I'll be just fine.
Your string twice:
I think I'll be just fine.
I think I'll be just fine.
Done.
Segmentation fault: 11
</pre>

<p><b>"Segmentation fault"</b> doesn’t sound healthy, and it isn’t. On a Unix system, this message indicates the program attempted to access memory not allocated to it.</p>

<p>For a while, many in the C programming community have recommended banishing gets()
from the programming vocabulary. The committee that created the C99 standard also
published a rationale for the standard. This rationale acknowledged the problems with gets() and discouraged its use. However, it justified keeping gets() as part of the standard because it was a convenient function, in the right circumstances, and because it was part of much existing code.</p>

<p>The C11 committee, however, has taken a tougher view and has dropped gets() from the
standard. However, a standard establishes what a compiler must support, not what it must not support. In practice, most compilers will continue to provide the function in the interests of backwards compatibility. But, as with the compiler we used, they don’t have to be happy about it.</p>

<h2>The Alternatives to gets()</h2>

<p>The traditional alternative to gets() is <a href="fgets.html">fgets()</a>, which has a slightly more complex interface and which handles input slightly differently. The C11 standard adds gets_s() to the mix. 
It’s a bit more like gets() and is more easily substituted into existing code as a replacement. However, it’s part of an optional extension to the stdio.h family of input/output functions, so C11 C compilers need not support it.</p>


<section>
<a href="system.html">&#171;Thermodynamic Systems</a>
<a href="index.html">Index</a>
<a href="continuity.html">Definizione limite per funzioni operanti tra spazi metrici o normati &#187;</a>
</section>

</div>

</body>
</html>
