<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="GtkTextView and GtkTextBuffer">
	<title>GtkTextView and GtkTextBuffer</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>GtkTextView and GtkTextBuffer</h1>

<p><b>GtkTextView</b> is a widget for multi-line text editing. <b>GtkTextBuffer</b> is a text buffer which is connected to <i>GtkTextView</i>.</p>

<pre>
#include &lt;gtk/gtk.h&gt;
 
static void
app_activate (GApplication *app) {
	GtkWidget *win;
	GtkWidget *tv;
	GtkTextBuffer *tb;
	gchar *text;

	text =
	"Anco regnante Lucumo, uir impiger ac diuitiis potens, Romam commigrauit cupidine maxime ac spe magni hono­ris, cuius adipiscendi Tarquiniis—nam ibi quoque peregrina a stirpe oriundus erat—facultas non fuerat. Demarati Corinthii filius erat, qui ob seditiones domo profugus cum Tarquiniis forte consedisset, uxore ibi ducta duos filios genuit. Nomina his Lucumo atque Arruns fuerunt. ";
	win = gtk_application_window_new (GTK_APPLICATION (app));
	gtk_window_set_title (GTK_WINDOW (win), "Ab Urbe Condita");
	gtk_window_set_default_size (GTK_WINDOW (win), 400, 300);

	tv = gtk_text_view_new ();
	tb = gtk_text_view_get_buffer (GTK_TEXT_VIEW (tv));
	gtk_text_buffer_set_text (tb, text, -1);
	gtk_text_view_set_wrap_mode (GTK_TEXT_VIEW (tv), GTK_WRAP_WORD_CHAR);

	gtk_window_set_child (GTK_WINDOW (win), tv);
 
	gtk_window_present (GTK_WINDOW (win));
}
 
int
main (int argc, char **argv) {
	GtkApplication *app;
	int stat;

	app = gtk_application_new ("com.github.gioretikto.textapp", G_APPLICATION_DEFAULT_FLAGS);
	g_signal_connect (app, "activate", G_CALLBACK (app_activate), NULL);
	stat = g_application_run (G_APPLICATION (app), argc, argv);
	g_object_unref (app);
	return stat;
}
</pre>

<p>A <i>GtkTextView</i> instance is created and its pointer is assigned to <code>tv</code>. Then the GtkTextBuffer instance is also created and connected to the GtkTextView. The pointer to the buffer is assigned to <code>tb</code>. Then, the text sample is assigned to the buffer. If the third argument of <code>gtk_text_buffer_set_text</code> is a positive integer, it is the length of the text. If len is -1, text must be nul-terminated. text must be valid UTF-8.</p>

<p>We can add or delete any characters on the <i>GtkTextView</i>, and your changes are kept in the <i>GtkTextBuffer</i>. If you add more characters beyond the limit of the window, the height increases and the window extends. If the height gets bigger than the height of the screen, you won't be able to control the size of the window or change it back to the original size. This can be solved by adding a <i>GtkScrolledWindow</i> between the <i>GtkApplicationWindow</i> and <i>GtkTextView</i>.</p>

<h2 id="scrolled">GtkScrolledWindow</h2>

<p>What we need to do is:</p>

<ul>
	<li><p>Create a GtkScrolledWindow and insert it as a child of the GtkApplicationWindow</p></li>
	<li><p>Insert the GtkTextView widget to the GtkScrolledWindow as a child.</p></li>
</ul>

<pre>
#include &lt;gtk/gtk.h&gt;
 
static void
app_activate (GApplication *app) {
	GtkWidget *win;
	GtkWidget *scr;
	GtkWidget *tv;
	GtkTextBuffer *tb;
	gchar *text;

	text = "Anco regnante Lucumo, uir impiger ac diuitiis potens, Romam commigrauit cupidine maxime ac spe magni hono­ris, cuius adipiscendi Tarquiniis—nam ibi quoque peregrina a stirpe oriundus erat—facultas non fuerat. Demarati Corinthii filius erat, qui ob seditiones domo profugus cum Tarquiniis forte consedisset, uxore ibi ducta duos filios genuit. Nomina his Lucumo atque Arruns fuerunt. ";
	win = gtk_application_window_new (GTK_APPLICATION (app));
	gtk_window_set_title (GTK_WINDOW (win), "Ab Urbe Condita");
	gtk_window_set_default_size (GTK_WINDOW (win), 400, 300);
 
	scr = gtk_scrolled_window_new ();
	gtk_window_set_child (GTK_WINDOW (win), scr);

	tv = gtk_text_view_new ();
	tb = gtk_text_view_get_buffer (GTK_TEXT_VIEW (tv));
	gtk_text_buffer_set_text (tb, text, -1);
	gtk_text_view_set_wrap_mode (GTK_TEXT_VIEW (tv), GTK_WRAP_WORD_CHAR);
 
	gtk_scrolled_window_set_child (GTK_SCROLLED_WINDOW (scr), tv);

	gtk_window_present (GTK_WINDOW (win));
}

int
main (int argc, char **argv) {
	GtkApplication *app;
	int stat;

	app = gtk_application_new ("com.github.gioretikto.scrolled", G_APPLICATION_DEFAULT_FLAGS);
	g_signal_connect (app, "activate", G_CALLBACK (app_activate), NULL);
	stat = g_application_run (G_APPLICATION (app), argc, argv);
	g_object_unref (app);
	return stat;
}
</pre>

<section aria-label="End">
<a href="packing.html">«Packing; GtkGrid</a>
<a href="index.html">Index</a>
<a href="sulfides.html">Sulfides»</a>
</section>

</article>

</body>
</html>
