<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Accelerators">
	<title>Accelerators</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>Accelerators</h1>

<p>This is an example of usage of accelerators</p>

<pre>
/* Called when Ctrl+B, Ctrl+i, etc is toggled */
void insertHtmlTags (struct lit *litos, const char *tag)
{
	char *string = NULL;

	char replaceString[350] = { 0 };

	GtkTextIter start_sel, end_sel;

	GtkTextBuffer *buffer = get_current_buffer(litos);

	if (gtk_text_buffer_get_selection_bounds(buffer, &start_sel, &end_sel))
	{
		string = gtk_text_buffer_get_text (buffer,
							&start_sel,
							&end_sel,
							FALSE);

		snprintf(replaceString, sizeof(replaceString), "<%s>%s</%s>", tag, string, tag);
		gtk_text_buffer_delete (buffer, &start_sel, &end_sel);
		gtk_text_buffer_insert (buffer, &start_sel, replaceString, (gint)strlen(replaceString));
	}

	else
	{
		snprintf(replaceString, sizeof(replaceString), "</%s>", tag);
		gtk_text_buffer_insert_at_cursor (buffer, replaceString,(gint)strlen(replaceString));
	}
}

void action_apply_heading(GSimpleAction *action, GVariant *parameter, gpointer userData)
{
	(void)action;
	guint32 headvalue;
	char heading[2];
	g_variant_get (parameter, "u", &headvalue);
	snprintf(heading,3, "h%d", headvalue);
	insertHtmlTags(userData, heading);
}


void set_acels (struct lit *litos)
{
	long unsigned int i;

	/* map actions to callbacks */
	const GActionEntry app_entries[] = {
		{"new", action_new_tab, NULL, NULL, NULL, {0,0,0}},
		{"esc", EscButtonPressed, NULL, NULL, NULL, {0,0,0}},
		{"open", action_open_dialog, NULL, NULL, NULL, {0,0,0}},
		{"save", action_save_dialog, NULL, NULL, NULL, {0,0,0}},
		{"save_as", action_save_as_dialog, NULL, NULL, NULL, {0,0,0}},
		{"bold", action_apply_bold, NULL, NULL, NULL, {0,0,0}},
		{"italic", action_apply_italic, NULL, NULL, NULL, {0,0,0}},
		{"h2", action_apply_heading, "u", NULL, NULL, {0,0,0}},
		{"h3", action_apply_heading, "u", NULL, NULL, {0,0,0}},
		{"close_tab", action_close_tab, NULL, NULL, NULL, {0,0,0}},
		{"quit", action_quit_activated, NULL, NULL, NULL, {0,0,0}}
	};

	/* define keyboard accelerators*/
	struct {
	  const gchar *action;
	  const gchar *accels[2];
	} action_accels[] = {
	  { "app.new", { "<Control>n", NULL} },
	  { "app.esc", { "Escape", NULL} },
	  { "app.open", { "<Control>o", NULL} },
	  { "app.bold", { "<Control>b", NULL} },
	  { "app.h2(uint32 2)", { "<Control>2", NULL} },
	  { "app.h3(uint32 3)", { "<Control>3", NULL} },
	  { "app.italic", { "<Control>i", NULL} },
	  { "app.close_tab", { "<Control>w", NULL} }
	};

	g_action_map_add_action_entries(G_ACTION_MAP(litos->app), app_entries, G_N_ELEMENTS(app_entries), litos);

	for (i = 0; i < G_N_ELEMENTS(action_accels); i++)
		gtk_application_set_accels_for_action(GTK_APPLICATION(litos->app), action_accels[i].action, action_accels[i].accels);
}
</pre>

<h2>GVariant Type Strings</h2>

<p>A GVariant type string can be any of the following:</p>

<ul>
	<li><p>any basic type string (listed below)</p></li>

	<li><p>"v", "r" or "*"</p></li>

	<li><p>one of the characters 'a' or 'm', followed by another type string</p></li>

	<li><p>the character '(', followed by a concatenation of zero or more other type strings, followed by the character ')'</p></li>

	<li><p>the character '{', followed by a basic type string (see below), followed by another type string, followed by the character '}'</p></li>
</ul>

<p>A basic type string describes a basic type (as per g_variant_type_is_basic()) and is always a single character in length. The valid basic type strings are "b", "y", "n", "q", "i", "u", "x", "t", "h", "d", "s", "o", "g" and "?".</p>

<p>The above definition is recursive to arbitrary depth. "aaaaai" and "(ui(nq((y)))s)" are both valid type strings, as is "a(aa(ui)(qna{ya(yd)}))". In order to not hit memory limits, GVariant imposes a limit on recursion depth of 65 nested containers. This is the limit in the D-Bus specification (64) plus one to allow a GDBusMessage to be nested in a top-level tuple.</p>

<p>The meaning of each of the characters is as follows:</p>

	<li><p>b: the type string of G_VARIANT_TYPE_BOOLEAN; a boolean value.</p></li>

	<li><p>y: the type string of G_VARIANT_TYPE_BYTE; a byte.</p></li>

	<li><p>n: the type string of G_VARIANT_TYPE_INT16; a signed 16 bit integer.</p></li>
	<li><p>q: the type string of G_VARIANT_TYPE_UINT16; an unsigned 16 bit integer.</p></li>

	<li><p>i: the type string of G_VARIANT_TYPE_INT32; a signed 32 bit integer.</p></li>
	<li><p>u: the type string of G_VARIANT_TYPE_UINT32; an unsigned 32 bit integer.</p></li>

	<li><p>x: the type string of G_VARIANT_TYPE_INT64; a signed 64 bit integer.</p></li>

	<li><p>t: the type string of G_VARIANT_TYPE_UINT64; an unsigned 64 bit integer.v

	<li><p>h: the type string of G_VARIANT_TYPE_HANDLE; a signed 32 bit value that, by convention, is used as an index into an array of file descriptors that are sent alongside a D-Bus message.</p></li>

	<li><p>d: the type string of G_VARIANT_TYPE_DOUBLE; a double precision floating point value.</p></li>

	<li><p>s: the type string of G_VARIANT_TYPE_STRING; a string.</p></li>
	<li><p>o: the type string of G_VARIANT_TYPE_OBJECT_PATH; a string in the form of a D-Bus object path.</p></li>

	<li><p>g: the type string of G_VARIANT_TYPE_SIGNATURE; a string in the form of a D-Bus type signature.</p></li>

	<li><p>?: the type string of G_VARIANT_TYPE_BASIC; an indefinite type that is a supertype of any of the basic types.</p></li>

	<li><p>v: the type string of G_VARIANT_TYPE_VARIANT; a container type that contain any other type of value.</p></li>

	<li><p>a: used as a prefix on another type string to mean an array of that type; the type string "ai", for example, is the type of an array of signed 32-bit integers.</p></li>

	<li><p>m: used as a prefix on another type string to mean a "maybe", or "nullable", version of that type; the type string "ms", for example, is the type of a value that maybe contains a string, or maybe contains nothing.</p></li>

	<li><p>(): used to enclose zero or more other concatenated type strings to create a tuple type; the type string "(is)", for example, is the type of a pair of an integer and a string.</p></li>

	<li><p>r: the type string of G_VARIANT_TYPE_TUPLE; an indefinite type that is a supertype of any tuple type, regardless of the number of items.</p></li>

	<li><p>{}: used to enclose a basic type string concatenated with another type string to create a dictionary entry type, which usually appears inside of an array to form a dictionary; the type string "a{sd}", for example, is the type of a dictionary that maps strings to double precision floating point values.</p></li>

	<li><p>The first type (the basic type) is the key type and the second type is the value type. The reason that the first type is restricted to being a basic type is so that it can easily be hashed.</p></li>

	<li><p>*: the type string of G_VARIANT_TYPE_ANY; the indefinite type that is a supertype of all types. Note that, as with all type strings, this character represents exactly one type. It cannot be used inside of tuples to mean "any number of items".</p></li>
</ul>


<section aria-label="End">
<a href="epoxides.html">«Epoxides</a>
<a href="index.html">Index</a>
<a href="sulfides.html">Sulfides»</a>
</section>

</article>

</body>
</html>
