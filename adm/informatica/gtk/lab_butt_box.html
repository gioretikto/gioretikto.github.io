<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="GtkLabel, GtkButton and GtkBox">
	<title>GtkLabel, GtkButton and GtkBox</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>GtkLabel, GtkButton and GtkBox</h1>

<p>The next widgets we introduce are GtkLabel, GtkButton and GtkBox.</p>

<h2>GtkLabel</h2>

<p>We made a window and showed it on the screen in the previous section. Now we go on and add some text to it; The simplest widget to accomplish this is through <b>GtkLabel</b>. It is a widget with text in it.</p>

<pre>
#include &lt;gtk/gtk.h&gt;
 
static void
app_activate (GApplication *app) {
	GtkWidget *window;
	GtkWidget *label;

	window = gtk_application_window_new (GTK_APPLICATION (app));
	gtk_window_set_title (GTK_WINDOW (window), "lb1");
	gtk_window_set_default_size (GTK_WINDOW (window), 400, 300);
 
	label = gtk_label_new ("Hello World");
	gtk_window_set_child (GTK_WINDOW (window), label);

	gtk_window_present (GTK_WINDOW (window));
}

int
main (int argc, char **argv) {
	GtkApplication *app;
	int stat;
	app = gtk_application_new ("org.gtk.example", G_APPLICATION_DEFAULT_FLAGS);
	g_signal_connect (app, "activate", G_CALLBACK (app_activate), NULL);
	stat =g_application_run (G_APPLICATION (app), argc, argv);
	g_object_unref (app);
	return stat;
}
</pre>

<p id="top">The code adds the label widget to the window widget using <code>gtk_window_set_child (GTK_WINDOW (window), label)</code> makes the label lab a child widget of <code>window</code>.  Child widgets are always located in their parent widget on the screen. See how the window has appeared on the screen. The application window includes the label.
The window win doesn't have any parent. We call such a window <b>top-level window</b>. An application can have more than one top-level windows.</p>

<h2>GtkButton</h2>

<p>The next widget we encounter is <b>GtkButton</b>. It displays a button on the screen with a label or icon on it. In this subsection, we will make a button with a label. When the button is clicked, it emits a "clicked" signal. The following program shows how to catch the signal and do something.</p>

<pre>
#include &lt;gtk/gtk.h&gt;

static void
click_cb (GtkButton *btn) {
	g_print ("Clicked.\n");
}
 
static void
app_activate (GApplication *app) {
	GtkWidget *win;
	GtkWidget *btn;
 
	win = gtk_application_window_new (GTK_APPLICATION (app));
	gtk_window_set_title (GTK_WINDOW (win), "lb2");
	gtk_window_set_default_size (GTK_WINDOW (win), 400, 300);

	btn = gtk_button_new_with_label ("Click me");
	gtk_window_set_child (GTK_WINDOW (win), btn);
	g_signal_connect (btn, "clicked", G_CALLBACK (click_cb), NULL);

	gtk_window_present (GTK_WINDOW (win));
}

int
main (int argc, char **argv) {
GtkApplication *app;
int stat;

	app = gtk_application_new ("org.gtk.example", G_APPLICATION_DEFAULT_FLAGS);
	g_signal_connect (app, "activate", G_CALLBACK (app_activate), NULL);
	stat =g_application_run (G_APPLICATION (app), argc, argv);
	g_object_unref (app);
	return stat;
}
</pre>

<h2 id="box">GtkBox</h2>

<p>GtkWindow and GtkApplicationWindow can have only one child. If you want to add two or more widgets in a window, you need a container widget. GtkBox is one of the containers (see the others <a href="packing.html">here</a>). It arranges two or more child widgets into a single row or column. The following procedure shows the way to add two buttons in a window.</p>

<ul>
	<li><p>Create a GtkApplicationWindow instance.</p></li>
	<li><p>Create a GtkBox instance and add it to the GtkApplicationWindow as a child.</p></li>
	<li><p>Create a GtkButton instance and append it to the GtkBox.</p></li>
	<li><p>Create another GtkButton instance and append it to the GtkBox.</p></li>
</ul>

<p>After this, the Widgets are connected as the following diagram.</p>

<table class="noborder">
<tr><td rowspan="3">GtkApplicationWindow ⊢</td> <td rowspan="2">GtkBox ⊢</td> <td>GtkButton</td></tr>
<tr> <td>GtkButton</td></tr>
</table>

<pre>
#include &lt;gtk/gtk.h&gt;

static void
click1_cb (GtkButton *btn) {
	const char *s;

	s = gtk_button_get_label (btn);
	if (g_strcmp0 (s, "Hello.") == 0)
	gtk_button_set_label (btn, "Good-bye.");
	else
	gtk_button_set_label (btn, "Hello.");
}

static void
click2_cb (GtkButton *btn, GtkWindow *win) {
	gtk_window_destroy (win);
}

static void
app_activate (GApplication *app) {
	GtkWidget *win;
	GtkWidget *box;
	GtkWidget *btn1;
	GtkWidget *btn2;

	win = gtk_application_window_new (GTK_APPLICATION (app));
	gtk_window_set_title (GTK_WINDOW (win), "lb4");
	gtk_window_set_default_size (GTK_WINDOW (win), 400, 300);

	box = gtk_box_new (GTK_ORIENTATION_VERTICAL, 5);
	gtk_box_set_homogeneous (GTK_BOX (box), TRUE);
	gtk_window_set_child (GTK_WINDOW (win), box);

	btn1 = gtk_button_new_with_label ("Hello.");
	g_signal_connect (btn1, "clicked", G_CALLBACK (click1_cb), NULL);

	btn2 = gtk_button_new_with_label ("Close");
	g_signal_connect (btn2, "clicked", G_CALLBACK (click2_cb), win);

	gtk_box_append (GTK_BOX (box), btn1);
	gtk_box_append (GTK_BOX (box), btn2);

	gtk_window_present (GTK_WINDOW (win));
}

int
main (int argc, char **argv) {
	GtkApplication *app;
	int stat;

	app = gtk_application_new ("org.gtk.example", G_APPLICATION_DEFAULT_FLAGS);
	g_signal_connect (app, "activate", G_CALLBACK (app_activate), NULL);
	stat = g_application_run (G_APPLICATION (app), argc, argv);
	g_object_unref (app);
	return stat;

}
</pre>

<p>The <i>GtkBox</i> widget is created with <code>gtk_box_new()</code>, which takes a <i>GtkOrientation</i> enumeration value as parameter. The buttons which this box will contain can either be laid out horizontally or vertically. This does not matter in this particular case, as we are dealing with only one button. After initializing box with the newly created <i>GtkBox</i>, the code adds the box widget to the window widget using <code>gtk_window_set_child()</code>. <br> Next the button variable is initialized in similar manner. <code>gtk_button_new_with_label()</code> is called which returns a GtkButton to be stored in button. Afterwards button is added to our box.</p>

<p>Using <code>g_signal_connect()</code>, the button is connected to a function in our app called <code>print_hello()</code>, so that when the button is clicked, GTK will call this function. As the <code>print_hello()</code> function does not use any data as input, <i>NULL</i> is passed to it. <code>print_hello()</code> calls <code>g_print()</code> with the string “Hello World” which will print Hello World in a terminal if the GTK application was started from one.</p>

<p>A slightly different code is the following.</p>

<pre>
#include &lt;gtk/gtk.h&gt;

static void
print_hello (GtkWidget *widget,
             gpointer   data)
{
  g_print ("Hello World\n");
}

static void
activate (GtkApplication *app,
          gpointer        user_data)
{
  GtkWidget *window;
  GtkWidget *button;
  GtkWidget *box;

  window = gtk_application_window_new (app);
  gtk_window_set_title (GTK_WINDOW (window), "Window");
  gtk_window_set_default_size (GTK_WINDOW (window), 200, 200);

  box = gtk_box_new (GTK_ORIENTATION_VERTICAL, 0);
  gtk_widget_set_halign (box, GTK_ALIGN_CENTER);
  gtk_widget_set_valign (box, GTK_ALIGN_CENTER);

  gtk_window_set_child (GTK_WINDOW (window), box);

  button = gtk_button_new_with_label ("Hello World");

  g_signal_connect (button, "clicked", G_CALLBACK (print_hello), NULL);
  g_signal_connect_swapped (button, "clicked", G_CALLBACK (gtk_window_destroy), window);

  gtk_box_append (GTK_BOX (box), button);

  gtk_widget_show (window);
}

int
main (int    argc,
      char **argv)
{
  GtkApplication *app;
  int status;

  app = gtk_application_new ("org.gtk.example", G_APPLICATION_DEFAULT_FLAGS);
  g_signal_connect (app, "activate", G_CALLBACK (activate), NULL);
  status = g_application_run (G_APPLICATION (app), argc, argv);
  g_object_unref (app);

  return status;
}
</pre>

<p id="swap">After connecting <code>print_hello()</code>, another signal is connected to the “clicked” state of the button using <code>g_signal_connect_swapped()</code>. This functions is similar to a <code>g_signal_connect()</code>, with the difference lying in how the callback function is treated; <code>g_signal_connect_swapped()</code> allows you to specify what the callback function should take as parameter by letting you pass it as data. In this case the function being called back is <code>gtk_window_destroy()</code> and the window pointer is passed to it. This has the effect that when the button is clicked, the whole GTK window is destroyed. In contrast if a normal <code>g_signal_connect()</code> were used to connect the “clicked” signal with <code>gtk_window_destroy()</code>, then the function would be called on button (which would not go well, since the function expects a GtkWindow as argument).</p>

<section aria-label="End">
<a href="window.html">«GtkApplication and GtkApplicationWindow</a>
<a href="index.html">Index</a>
<a href="packing.html">Packing; GtkGrid»</a>
</section>

</article>

</body>
</html>
