<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Macros">
	<title>Macros</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>Macros</h1>

<p>The <code>#define</code> directive can be used to give a name to an instruction or a group of instructions. A <b>macro</b> is a single −made up− command word standaind in for other instructions, which will replace it when the program is compiled.</p>

<pre>#define DISPLAY_GREETING printf("Hello\n")</pre>

<p>defines a macro called <code>DISPLAY_GREETING</code>. Once it has been defined, the macro <code>DISPLAY_GREETING</code> can then be used anywhere in the program instead of the command <code>printf("Hello\n")</code>. Before the program compiles − the preprocessor will go through the code finding each occure of the word <code>DISPLAY_GREETING</code> and replacing it with the command  <code>printf("Hello\n")</code>.</p>

<p>Othr examples are:</p>

<pre>#include &lt;stdio.h&gt;

#define SUM(x, y) (x + y)

int main(int argc, char *argv[])
{
	int a = 5;
	int b = 10;
	int sum = SUM(a, b);
	printf("%d\n", sum);
}
</pre>

<p>gets preprocessed into</p>

<pre>
/* Preprocessed code omitted */

int main(int argc, char *argv[])
{
	int a = 5;
	int b = 10;
	int sum = (a + b);
	printf("%d\n", sum);
}
</pre>

<p>A whole group of instructions may be given a name. When a definition takes up several lines, the backslash character (\) is used at the end of each line of the definition (except the last) to indicate that the definition continues on the next line.</p>

<pre>#define DRAW_SQUARE printf("* * * *\n");\
		 	 printf("* * * *\n");\
		 	 printf("* * * *\n");\
		 	 printf("* * * *\n");</pre>

<p>Once defines, the macro <code>DRAW_SQUARE</code> may then be used within the program text and will be replaced at compile time by the set of <code>printf</code> statements which make up its definition.</p>

<h2>Macros vs. Functions</h2>

<p>A macro may be given its own local variables − by making use of the fact that a block of code (i.e. instruction between { and }) can have variables which are local to the block.</p>

<pre>#define DRAW_LINE			\
			{ int i;	\
			for (i = 1; i <= 4; i++)	\
			printf("* * * *");		\
			}
</pre>

<p>This example shows that a <i>macro</i> can be used instead of a function. <br> However, when a <i>function</i> is used, a single copy of the function instructions is stored in memory when the program is running. Control of the computer is passed to the function when it is required to carry out a task −and back to the <i>main</i> program (or whichever other function called it) when it is has done its work − until it is needed again. In the case of a <i>macro</i>, a copy of the set of instructions is stored in memory at every point in the program that the <i>macro</i> name was mentioned. So, in general, a program using <i>macros</i> will take up more memory space thatn the same program using <i>functions</i> −but will run faster (because no time is lost passing control over to the function and back again).</p>

<h2>Macros using arguments</h2>

<p>Arguments may be placed in brackets after macro names. These arguments can then be replaced by specified text which may be different each time the macro is used in the program.</p>

<pre>#define ADDUP (res, x, y)	res = x + y</pre>

<p>This example defines a macro which will add two values (<i>x</i> and <i>y</i>) together and place the result in a variable (<i>res</i>). When the macro is used in the program −three arguments must be specified to conform to those in the macro definition. Note that in the example the firct actual argument must be the name of a variable −because it will receive information.</p>

<pre>ADDUP (result, 5,6)</pre>

<p>The preprocessor will replace the macro in the code with <i>result</i> = 5 + 6; and the this instructions will be compiled.</p>

<p>Alternatively, variables could be used for all the arguments.</p>

<pre>ADDUP (total_mark, chemistry_mark, math_mark)</pre>

<p>Before, compilation the preprocessor will convert this line to − <i>total_mark</i> = <i>math_mark</i> + <i>chemistry_mark</i>;</p>

<p>Using local variables within a block can be useful in a macro definition.</p>

<pre>#define DRAW_LINE (length)		\
		{int count;		\
		
		for (count = 1; count <= length; count++	\
			printf("*");				\
		}</pre>

<p>will now draw a line of five asterisks.</p>

<p><b>Nota bene</b>: Do not confuse this use of arguments with their use in functions −where data is actually transferred into temporary memory locations when parameters are passed. Macros are purely concerned with textual substitution.</p>

<h2>Predefined Macros</h2>

<p>The ANSI C standard defines several macros for the use in C language. The macros that are already defined in C language are known as predefined macros. These macros can be used without defining them.	</p>

<ul>
	<li><code>__FILE__</code>: this macro expands to the current line number in the source file. The expanded line number is a deciaml integer constant. The line number can be altered with the help of the <i>line</i> directive.</p>

<pre>
#include &lt;stdio.h&gt;
int main()
{
	printf("Current line number is %d", __LINE__);
	return 0;
}
</pre>

<p>Give as output:</p>

<pre>Current line is 4</pre>

</li>

<li><code>__DATE__</code>: macro that expands to a string constant that describes the time at which the C preprocessor is being invoked. The expand string costant is eight characters long and is of the form "hh:mm:ss". If we replace this line in the above code</p>

<pre>printf("Date of compilation is %s", __DATE__);</pre>

<p>Will give as output:</p>

<pre>Date of compilation Jul 16 1989</pre>

</li>

<li><code>__TIME__</code>: expands to a string constant that described the time at which the C preprocessor is being invoked. The expanded string constant is eight characters long and is of the form "hh:mm:ss".</p>

<pre>printf("Time of preprocessing is %s", __TIME__);</pre>

<p>Will give as output:</p>

<pre>Time of preprocessing is 19:23:12</pre>

</li>

</ul>

<section aria-label="End">
<a href="epoxides.html">«Epoxides</a>
<a href="index.html">Index</a>
<a href="sulfides.html">Sulfides»</a>
</section>

</article>

</body>
</html>
