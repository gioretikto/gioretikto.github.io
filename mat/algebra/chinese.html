<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="description" content="System of congruences"/>
    <title>System of congruences</title>
    <link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
    <ul>
        <li><a class="navbar" href="../../index.html">Home</a></li>
        <li><a class="navbar" href=/index.html">Algebra</a></li>
    </ul>
</nav>
      
<div class="content">

<h1>System of congruences</h1>

<p>We now focus on the solution of a <i>system</i> of conguences. We look for a simultaneous solution for all congruences in the system. Let</p>

<div class="eq">
<p><i>
x</i> ≡ 2 (mod 3);<br>
x</i> ≡ 3 (mod 5);<br>
x</i> ≡ 2 (mod 7).
</p>
</div>

<p>The first congruence means <i>x</i> = 2, 5, 8, 11, 14, 17, 20, 23, 26, ..., are possible solutions; the second congruence yields <i>x</i> = 3, 8, 13, 18, 23, 28, 33, 38, ... ; and the third produces <i>x</i> = 2, 9, 16, 23, 30, 37, 44, ... . Since 23 appears on all three lists, <i>x</i> = 23 is the solution of the system. Moreover, if you were to extend each of these lists as far as 100, you would see that 23 is the only number that is common to all three lists, that is, 23 is the unique solution to this system of congruences modulo 105.</p>

<p><b>Lemma 4.22</b>. Let</p>

<div class="eq">
<p><i>a<sub>1</sub>x ≡ b<sub>1</sub></i> &emsp;mod n<sub>1</sub></p>
<p>&emsp;&emsp;&emsp;&emsp;<i>a<sub>2</sub>x ≡ b<sub>2</sub></i> &emsp;mod <i>n<sub>2</sub></i> &emsp; (<b>4.5</b>)</p>
<p>...</p>
<p><i>a<sub>s</sub>x ≡ b<sub>3</sub></i> &emsp; mod <i>n<sub>s</sub></i></p>
</div>

<p>with (<i>n<sub>i</sub>,n<sub>j</sub></i>) = 1, for <i>i &ne; j</i>, will suppose also that (<i>n<sub>i</sub>,n<sub>j</sub></i>) = 1, for <i>i &ne; j</i> in which every congruence adimits solutions. This system can be equally represented (in the sense, they both admits the same solutions), as</p>

<div class="eq">
<p><i>x ≡ c<sub>1</sub></i> &emsp;mod <i>n</i>'<sub>1</sub></p>
<p>&emsp;&emsp;&emsp;&emsp;<i>x ≡ c<sub>2</sub></i> &emsp; mod n'<sub>2</sub> &emsp; (<b>4.6</b>)</p>
<p>...</p>
<p><i>x ≡ c<sub>3</sub></i> &emsp; mod n<sub>s</sub></p>
</div>

<p>with (<i>n'<sub>i</sub>,n'<sub>j</sub></i>) = 1, for <i>i &ne; j</i>.</p>

<p><b>Proof</b>. System 4.5 is solvable if for every <i>k</i> = 1,...,<i>s</i>, <i>d<sub>k</sub></i> = gcd(<i>a<sub>k</sub>,n<sub>k</sub></i>)|<i>b<sub>k</sub></i> (<a href="linear_congruences.html">Proposition 4.18</a>). In this case, it is possible to divide the <i>k</i>-th congruence by <i>d<sub>k</sub></i>, obtaining the new system equivalent to the first</p>

<div class="eq">
<p><i>a'<sub>1</sub>x ≡ b'<sub>1</sub></i> &emsp;mod n'<sub>1</sub></p>
<p>&emsp;&emsp;&emsp;&emsp;<i>a'<sub>2</sub>x ≡ b'<sub>2</sub></i> &emsp;mod n'<sub>2</sub> &emsp; (<b>4.5'</b>)</p>
<p>...</p>
<p><i>a'<sub>s</sub>x ≡ b'<sub>3</sub></i> &emsp; mod <i>n'<sub>s</sub></i></p>
</div>

<p>where <i>a<sub>k</sub>'</i> = a<sub>k</sub>/d<sub>k</sub>, b<sub>k</sub>'</i> = b<sub>k</sub>/d<sub>k</sub></i> and <i>n<sub>k</sub>'</i> = n<sub>k</sub>/d<sub>k</sub></i> and with the condition (<i>n'<sub>i</sub>,n'<sub>j</sub></i>) = 1, for <i>i &ne; j</i> still holding. Now by noting that for each congruence of the system <i>k</i> = 1,...,<i>s</i> we have that (<i>a'<sub>k</sub>,n'<sub>k</sub></i>) = 1, by Corollary 4.21 the system admits a unique solution <i>c<sub>k</sub></i> modulo <i>n'<sub>k</sub></i>. For this we can replace the system 4.5' with 4.6. Thus we proved that any system of the form 4.5 can be reduced to one of the form 4.5'. □</p>

<p>A clever method appearted first in the bookd <i>The Art of War</i>, by Sun Tsu, in the 3rd century AD, allows one to deduce an integer from its approximate size and its least nonnegative remainder modulo <i>m</i>, for a few small <i>m</i>. One early application was to count soldiers. It is sufficient to request the soldiers to line up 5 abreast, then 8, then 19, and to count each time how many soldiers are not lined up: these remainders r<sub>i</sub>, for i = 1, 2 and 3, are smaller than 5, 8, and
19, respectively.</p>

<p><b>Theorem 4.23</b> (<i>Chinese remainder theorem</i>). A systems of congruences,</p>

<div class="eq">
<p><i>x ≡ c<sub>1</sub></i> &emsp;mod r<sub>1</sub></p>
<p>&emsp;&emsp;&emsp;&emsp;<i>x ≡ c<sub>2</sub></i> &emsp; mod <i>r</i><sub>2</sub> &emsp; (<b>4.7</b>)</p>
<p>...</p>
<p><i>x ≡ c<sub>3</sub></i> &emsp; mod r<sub>s</sub></p>
</div>

<p>with gcd(<i>r<sub>i</sub>, r<sub>j</sub></i>) = 1 for all pairs (i, j) with <i>i &ne; j</i>, admits a solution. This solution is unique modulo <i>R = r<sub>1</sub> r<sub>2</sub> ··· r<sub>s</sub></i>.</p>

<p><b>Proof</b>. Let <i>R<sub>k</sub> = R/r<sub>k</sub></i>; the hyphotesis gcd(<i>r<sub>i</sub>, r<sub>j</sub></i>) = 1 implies that gcd(<i>R<sub>k</sub>, r<sub>k</sub></i>) = 1. So the <i>k</i>-th congruence</p>

<div class="eq">
<p><i>R<sub>k</sub> x ≡ c<sub>k</sub></i> &emsp; (mod r<sub>k</sub>)</p>
</div>

<p>admits as unique solution, <i>x̄<sub>k</sub></i>, modulo <i>r<sub>k</sub></i> (as stated in <a href="linear_congruences.html">Proposition 4.18</a>), the number</p>

<div class="eq">
<p><i>x̄ = R<sub>1</sub> x̄<sub>1</sub> + R<sub>2</sub> x̄<sub>2</sub> + ... + R<sub>s</sub> x̄<sub>s</sub></i></p>
</div>

<p>indeed as <i>R<sub>i</sub></i> is a multiple of <i>r<sub>k</sub></i> for <i>i &ne; k</i>, we have</p>

<div class="eq">
<p><i>R<sub>i</sub></i> ≡ 0 (mod <i>r<sub>k</sub></i>) &emsp; for <i>i &ne; k</i></p>
</div>

<p>and so</p>

<div class="eq">
<p><i>x̄ ≡ R<sub>1</sub>x̄<sub>1</sub> ≡ c<sub>1</sub></i> &emsp;mod r<sub>1</sub></p>
<p>&emsp;&emsp;&emsp;&emsp;<i>x̄ ≡ R<sub>2</sub>x̄<sub>2</sub> ≡ c<sub>2</sub></i> &emsp; mod r<sub>2</sub> &emsp; (<b>4.6</b>)</p>
<p>...</p>
<p><i>x̄ ≡ R<sub>3</sub>x̄<sub>3</sub> ≡ c<sub>3</sub></i> &emsp; mod r<sub>s</sub></p>
</div>

<p>thus x̄ is a solution of the system.</p>

<p>As to the unicity modulo <i>R</i>, let <i>ȳ</i> be another solution of the system; in other words, assume that</p>

<div class="eq">
<p><i>x̄ ≡ c<sub>k</sub> ≡ ȳ</i> &emsp; (mod <i>r<sub>k</sub></i>),  &emsp; for <i>k</i> = 1, ..., s.</p>
</div>

<p>so ȳ ≡ x̄ (mod <i>r<sub>k</sub></i>) for each <i>k</i>. Thus <i>r<sub>k</sub></i> | (<i>x̄ − ȳ</i>) for each <i>k</i>. But
then, by <a href="diophantine.html">Corollary 2.20</a>, since the <i>r<sub>k</sub></i> are pairwise relatively prime, <i>r<sub>k</sub></i> | (<i>x̄ − ȳ</i>), and
ȳ ≡ x̄ (mod <i>R</i>).□</p>

<p><b>Example 4.24</b>. Solve the problem of counting a few hundred soldiers by linining them up by 7, 10 and 13. For each alignment we have the remainders r<sub>1</sub> = 1, r<sub>2</sub> = 3, and r<sub>3</sub> = 8. Then we can set up the system</p>

<div class="eq">
<p><i>
x</i> ≡ 1 (mod 7);<br>
x</i> ≡ 3 (mod 10);<br>
x</i> ≡ 8 (mod 13).
</p>
</div>

<p>By the Chinese remainder theorem, it admits a unique solution modulo <i>R</i> = 7 ⋅ 10 ⋅ 13 = 910. We have <i>R<sub>1</sub></i> = 10 ⋅ 13 = 130; <i>R<sub>2</sub></i> = 7 ⋅ 13 = 91; <i>R<sub>3</sub></i> = 7 ⋅ 10 = 70. Thus we need to solve the following congruences</p>

<div class="eq">
<p>130 ⋅ x ≡ 1 (mod 7)</p>
<p>91 ⋅ x ≡ 3 (mod 10)</p>
<p>70 ⋅ x ≡ 8 (mod 13)</p>
</div>

<p>The solution of the first congruence x = 2;</p>

<p>For the 2nd congruence first note that 91 ≡ 1 (mod 10), so 1 is the multiplicative inverse then x = 3.</p>

<p>For the 3rd congruence we notice that 5 ⋅ x ≡ 8 (mod 13), we find the multiplicative inverse of 5 mod 13: 5 ⋅ x ≡ 1 mod 13 which is 8 so by multiplying by 8 both sides we get 8 ⋅ 5 ⋅ x ≡ 8 ⋅ 8 (mod 13) since 8 · 5 ≡ 1 (mod 13), x = 8.</p>

<p>x̄ = 2⋅130 + 3⋅91 + 70⋅64 = 5013 ≡ 463 (mod 910)</p>

<p>Since there a few hundred soldiers, there must be exaclty 463 of them, as the next integer solution would be 463 + 910 = 1373.</p>

<p><b>Example 4.25</b> - Suppose, that lining up a group of pupils (&lt; 1000) five abreast, one of them is not lined up, when eight abreast, 2 are not lined up, and when 19 abreast, 3 are not lined up. Then <i>r<sub>1</sub></i> = 1, <i>r<sub>2</sub></i> = 2 and <i>r<sub>3</sub></i> = 3. How many pupils are there?</p>

<p><b>Solution</b>. In this case the number of the students is found by finding the solution, unique modulo <i>R</i> = 5 ⋅ 8 ⋅ 19 = 760, of the system</p> 

<div class="eq">
<p>x ≡ 1 (mod 5),</p>
<p>x ≡ 2 (mod 8),</p>
<p>x ≡ 3 (mod 19).</p>
</div>
</p>

<p>We have <i>R<sub>1</sub></i> = 8 · 19 = 152, <i>R<sub>2</sub></i> = 5 · 19 = 95, <i>R<sub>3</sub></i> = 5 · 8 = 40;  We need to find solutions for the system</p>

<div class="eq">
<p>152 ⋅ x ≡ 1 (mod 5)</p>
<p>95 ⋅ x ≡ 2 (mod 8)</p>
<p>40 ⋅ x ≡ 3 (mod 19)</p>
</div>

<p>The first congruence has x = 3 has solution. The second x = 6, so, the thirs x = 11; thus a solution is 3 · 152 + 6 · 95 + 11 · 40 = 1466 ≡ 706 mod 760. As 706 is the only solution smaller than 1000, this is the result we were looking for.</p>

<p>There is a useful consequence or, can also be seen as a different interpretation of the Chinese remainder theorem. Let ℤ<sub>r</sub>× ℤ<sub>s</sub> be the Cartesian product of ℤ<sub>r</sub> and ℤ<sub>s</sub>. As ℤr and ℤ<sub>s</sub> are rings, the set ℤ<sub>r</sub> × ℤ<sub>s</sub> itself is in a natural way a product ring, in which the operations are defined by definition</p>

<div class="eq">
<p>(ā<sub>r</sub>, b̄<sub>s</sub>) + ā'<sub>r</sub>, b̄'<sub>s</sub>) := (ā<sub>r</sub> + c̄<sub>r</sub>, b̄<sub>s</sub> + b̄'<sub>s</sub>),</p>
<p>(ā<sub>r</sub>, b̄<sub>s</sub>) · (ā'<sub>r</sub>, b̄'<sub>s</sub>) := (ā<sub>r</sub>· c̄<sub>r</sub>, b̄<sub>s</sub> · b̄'<sub>s</sub>).</p>
</div>

<p>The following proposition is an immediate consequence of the Chinese remainder theorem.</p>

<p><b>Proposition 4.26</b>. Let <i>r</i> and <i>s</i> be two relatively prime integers greater than 1. The map</p>

<div class="eq">
<p><i>f: ℤ<sub>rs</sub> → ℤ<sub>r</sub>× ℤ<sub>s</sub>,</i></p>
</div>

<p>defined by</p>

<div class="eq">
<p><i>f</i>(<i>x̄</i><sub>rs</sub> ) = (<i>x</i>]<sub>r</sub>, [<i>x</i>]<sub>s</sub>),</p>
</div>

<p>is such that</p>

<div class="eq">
<p><i>f</i>(x̄<sub>rs</sub> + ȳ<sub>rs</sub>) = f(x̄<sub>rs</sub>) + f(ȳ<sub>s</sub>),</p>
<p><i>f</i>(x̄<sub>rs</sub> · ȳ<sub>rs</sub>) = f(x̄<sub>rs</sub>) · f(ȳ<sub>s</sub>),</p>
</div>

<p><b>Proof</b>. By the Chinese remainder theorem the system of congruences</p>

<div class="eq">
<p><i>x ≡ a</i> (mod <i>r</i>),</p>
<p><i>x ≡ b</i> (mod <i>s</i>)</p>
</div> 

<p>admits exactly one solution modulo <i>rs</i>. This implies the surjectivity and the injectivity of the map. The fact that this map preserves the operations is left to the reader.</p>

<section>
<a href="inverse.html">&#171;Solving linear congruences; Inverses</a>
<a href="index.html">Index</a>
<a href="euclid_algorithm.html">Euclidean Algorithm &#187;</a>
</section>

</div>

</body>
</html>
