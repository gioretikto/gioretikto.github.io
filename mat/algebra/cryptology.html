<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Cryptology"/>
	<title>Cryptology</title>
	<link rel="stylesheet" type="text/css" href="../../style.css" media="screen">
</head>

<body>

<nav>
	<ul>
		<li><a class="navbar" href="../../index.html">Home</a></li>
		<li><a class="navbar" href="index.html">Index</a></li>
	</ul>
</nav>

<article>

<h1>Cryptology</h1>

<p>We see now some applications of Euler's theorem in the field of Cryptology, the science of secure messages. The aim of cryptography is to send messages across a channel so that only the intended recipient of the message can read it.</p>

<p>The message to be sent is called the <b>plaintext</b> message. The disguised message is called the <b>ciphertext</b>. The plaintext and the ciphertext are both written using alphanumeric characters. Characters can include the familiar alphabetic characters <i>a, A, ..., Z, z</i> and also digits, punctuation marks, and blanks. A <b>cryptosystem</b>, or <b>cipher</b>, is characterized by two parts: <b>encryption</b>, the process of transforming a plaintext message to a ciphertext message, and <b>decryption</b>, the reverse transformation of changing a ciphertext message into a plaintext message.</p>

<p>With <b>private key</b> (<b>symmetric</b>) encryption, you use a key to encrypt data and then use the same key to decrypt that data.</p>

<p>An early cryptological system, called the Caesar cipher, was employed by Julius Caesar in the Gallic wars. Julius Caesar used a cipher that simply shifted each letter in the alphabet three letters to the right in this way (<i>A</i> → <i>D</i>, <i>B</i> → <i>E</i>, etc.). This is an example of a <i>shift cipher</i>, sometimes called a <i>Caesar cipher</i>, in which each letter is shifted by a fixed number, <i>k</i>, of places in the alphabet. This is equivalent to representing each letter from A to Z by the “numbers” 1, 2, 3, ..., 25 and the cipher merely replaces a given letter <i>X</i> by the letter <i>X + k</i>. In the cipher adopted by Ceaser</p>

<div class="eq">
<p><i>x</i> ↦ <i>x</i> + 3</p>
</div>

<p>to 1, i.e. <i>A</i>, corresponds 1 + 3 = 4, thus <i>D</i>, to <i>B</i> = 2 corresponds 2 + 3 = 5 which is <i>E</i> and so on. If we try now to cipher the letter <i>X</i> which corresponds to 24 we get 24 + 3 = 27 which does not correspond to any letter. To avoid this inconvenient, and be able to assign all letters of the alphabet we operate mod 26. </p>

<div class="eq">
<p><i>x</i> ↦ <i>x</i> + 3 &emsp; mod 26&emsp; (<b>4.11</b>)</p>
</div>

<p>Accepting the notational convention: <i>a</i> mod <i>n</i> is the remainder when <i>a</i> is divided by <i>n</i>; in this way 27 mod 26 = 1 and 1 corresponds to <i>A</i>. Analogously for <i>Y</i> = 25 and 28 ≡ 2 mod 26, yielding the <i>B</i> letter.</p>

<p>That is there is a bijective function on the set of the Alphabet letters which can be inverted by the receiver to decipher the crypted message. This is equivalent to say that function (4.11) is a bijection on the set ℤ<sub>26</sub> = {[1], [2], ..., [26]}. We can invert 4.11 obtaining <i>x ≡ y</i> − 3 (mod 21). So if <i>y</i> = 4 is the cipher text which corresponds to <i>D</i>, we have <i>x</i> ≡ 1  mod 21, so the original message is <i>x</i> = 1 which is <i>A</i>.</p>

<p>Inspired by this result we can choose different enciphering functions, for example</p>

<div class="eq">
<p><i>x</i> ↦ <i>ax</i> + <i>b</i>&emsp; mod 26</p>
</div>

<p>now if we take <i>a</i> = 5 and <i>b</i> = 3, then the letter <i>D</i> which is <i>x</i> = 4, is ciphered to 5<i>x</i> + 3 = 23 (mod 21) thus 23 ≡ 2 (mod 21), and <i>y</i> = 2 is letter <i>B</i>.</p>

<p>We must be careful when chosing <i>a</i>, because as we said the enciphering must be biunique, which is equivalent to say that the equation <i>ax</i> + <i>b</i> ≡ <i>y</i> mod 26 must have a unique solution. By taking <i>b</i> to the right side we have the equivalente equation <i>ax</i> ≡ <i>y</i> − <i>b</i> mod 26. We have seen the condition for the existence of such an unique solution of this equation is (<i>a</i>,26) = 1 (see <a href="linear_congruences.html">Proposition 4.18</a>). This condition guarantees <i>a</i> to have an inverse <i>a</i><sup>−1</sup> mod 26 and consequently by multiplying both sides of the equation by <i>a</i><sup>−1</sup></p>

<div class="eq">
<p><i>x</i> ≡ <i>a</i><sup>−1</sup> (<i>y</i> − <i>b</i>)&emsp; mod 26</p>
</div>

<p>which is the inverse function to decipher the message.</p>

<h2>Public-Key Systems: RSA</h2>

<p>Let’s look at the RSA encryption system by Rivest, Shamir, and Adleman based on the difficulty of factoring large numbers and on (Euler’s theorem of 1760) to make this work. We begin by choosing two distinct prime numbers, which we label as <i>p</i> and <i>q</i>, and we form the product</p>

<div class="eq">
<p><i>n</i> = <i>pq</i></p>
</div>

<p>This is the heart of the matter: the value of <i>n</i> is public information, but the values of <i>p</i> and <i>q</i> are secret. The larger the value of <i>n</i>, the more secure this system will be, since breaking the code relies on knowing the prime factors <i>p</i> and <i>q</i> of <i>n</i>. Next we choose <i>e</i> to be relatively prime to the product <i>&phi;</i>(<i>n</i>) = (<i>p</i> − 1)(<i>q</i> − 1); that is, <i>e</i> is defined by (<i>e, &phi;</i>(<i>n</i>)) = 1.</p>

<p>The exponential enciphering operation is <i>y</i> ≡ <i>x</i><sup>e</sup> (mod <i>n</i>).</p>

<p>We suppose the message <i>x</i> to satisfy the following condition: <i>x</i> &lt; <i>n</i>.</p>

<p>The first requirement  For the second is enough to chunk the original message into smaller pieces.</p>

<p>The receiver who got the ciphertext <i>y</i> can decipher it in the following way: since <i>e</i> is relatively prime to <i>φ</i>(<i>n</i>), it is invertible modulo φ(<i>n</i>); we call its inverse <i>d</i>.</p>

<div class="eq">
<p><i>d</i> ⋅ <i>e</i> ≡ 1 &emsp; mod <i>&phi;</i>(<i>n</i>)</p>
</div>

<p>At this point we affirm that the plaintext <i>x</i> can be recovered by the inverse mapping</p>

<div class="eq">
<p><i>x</i> ≡ <i>y</i><sup>d</sup> &emsp; (mod <i>n</i>).</p>
</div>

<p><b>Proof</b>. Since <i>y</i> ≡ <i>x</i><sup>e</sup> (mod <i>n</i>) elevating to the power <i>d</i> we have</p>

<div class="eq">
<p><i>y</i><sup>d</sup></i> ≡ (<i>x</i><sup>e</sup>)<sup>d</sup> ≡ <i>x<sup>ed</sup></i> &emsp; (mod <i>n</i>)</p>
</div>

<p>to conclude that <i>y</i> ≡ <i>x</i><sup>e</sup> (mod <i>n</i>) is enough to prove that</p>

<div class="eq">
<p><i>x<sup>ed</sup></i> ≡ <i>x</i> &emsp; (mod <i>n</i>).</p>
</div>

<p>We use now Euler’s theorem, under the conditions (<i>x,n</i>) = 1 (this is always possible to attain: if <i>x</i> is not relatively prime to <i>n</i> add a letter to it), and <i>x</i> &lt; <i>n</i>. We have<p>

<div class="eq">
<p><i>x</i><sup>&phi;(<i>n</i>) ≡ 1 &emsp; mod <i>n</i></p>
</div>

<p>by definition <i>d</i> is the inverse of <i>e</i> mod &phi;(<i>n</i>) i.e. ed ≡ 1 mod <i>&phi;</i>(<i>n</i>) which means in other words, there exists an integer <i>k</i> such that <i>ed</i> = 1 + k&phi;(<i>n</i>). Thus we can write</p>

<div class="eq">
<p><i>x<sup>ed</sup></i> ≡ <i>x</i><sup>1 + <i>k&phi;</i>(<i>n</i>)</sup> &emsp; mod <i>n</i> &emsp; (<b>4.12</b>)</p>
</div>

<p>By <a href="euler.html#theorem">Euler’s theorem</a>, x<sup>φ(<i>n</i>)</sup> ≡ 1 (mod <i>n</i>), if we both sides of the congruence by <i>k</i> we have</p>

<div class="eq">
<p><i>x</i><sup>k&phi;(<i>n</i>)</sup> ≡ (<i>x</i><sup>&phi;(<i>n</i>)</sup>)<sup>k</sup> ≡ 1 &emsp; mod <i>n</i></p>
</div>

<p>then by multiplying both members of this equality by <i>x</i> we get</p>

<div class="eq">
<p><i>x</i> ⋅ <i>x</i><sup><i>k&phi;</i>(<i>n</i>)</sup> ≡ <i>x</i> ⋅ 1 &emsp; mod <i>n</i></p>
</div>

<p>thus</p>

<div class="eq">
<p>x</i><sup>1 + k&phi;(<i>n</i>)</sup> ≡ <i>x</i> &emsp; mod <i>n</i> &emsp; (<b>4.13</b>)</p></p>
</div>

<p>by adding up (4.12) and (4.13) we completed the proof.□</p>

<div class="def">
<p><b>Example</b>. Suppose the sender wants to comunicate the message <i>x</i> = 3 to a receiver whose public key (<i>n,e</i>) = (35,5) supposing <i>p</i> = 7, <i>q</i> = 5: then <i>n</i> = 35  and <i>e</i> = 5 and <i>φ</i>(35) = (7 − 1)(5 − 1) = 24.</p> 

<div class="eq">
<p><i>x<sup>e</sup></i> = 3<sup>5</sup> = 243 ≡ 33 mod 35</p>
</div>

<p>He sends the ciphertext <i>y</i> = 33. The receiver to decipher the message has to use the inverse of <i>e</i> = 5. In this simple case we are able to calculate <i>d</i></p>

<div class="eq">
<p>5<i>d</i> ≡ 1 &emsp; mod 24</p>
</div>

<p>so that <i>d</i> = 5. The receiver decrypts the message calculating</p>

<div class="eq">
<p><i>x</i> ≡ <i>y<sup>d</sup></i> = 33<sup>5</sup> = 39135393 ≡ 3 &emsp; mod 35</p>
</div>

<p>retriving the original message <i>x</i> = 3.</p>

</div>

<h2>Authentication of signatures with the RSA system</h2>

<p>The RSA cryptosystem, allows one to solve of an important problem which is more and more relevant in this era of telecommunications: the problem of digitally authenticating a signature. If Bob receives a message from a person signing herself Alice, how can he be sure the sender was actually Alice? The certainty may be achieved as follows. Alice writes her message <i>M<sub>1</sub></i>, putting at the end her signature <i>F</i>; to authenticate the signature, Alice adds after the message <i>M</i><sub>1</sub> the message</p>

<div class="eq">
<p><i>M</i><sub>2</sub> = <i>F<sup>d<sub>A</sub></sup></i> mod <i>n<sub>A</sub></i></p>
</div>

<p>where <i>d<sub>A</sub></i> is her private key, that is, the key known only to her, because only she knows the factorisation of her public key n<sub>A</sub>. Then she sends Bob the message <i>M</i> consisting of the two messages <i>M</i><sub>1</sub> and <i>M</i><sub>2</sub> as usual, that is, raising <i>M</i><sub>1</sub> and <i>M</i><sub>2</sub> to the power <i>e<sub>B</sub></i> and reducing them modulo <i>n<sub>B</sub></i>.</p>

<p>On receiving the message, Bob reads it using her private key <i>d<sub>B</sub></i>. Deciphering message <i>M</i><sub>1</sub>, she learns that the message was sent by Alice, because the message is signed with Alice’s signature <i>F</i>. But was really Alice, and not someone else, who used that signature? Here the section <i>M</i><sub>2</sub> of the message gives an answer. Indeed, it consists of some undecipherable characters, which nevertheless contain the proof of the authenticity of the signature. Now Bob, to verify the authenticity, has to proceed as follows. To decipher <i>M</i><sub>2</sub> she cannot use her private key <i>d<sub>B</sub></i>, which would be useless, as the original message <i>F</i> was enciphered raising it not to the power <i>e<sub>B</sub></i> but to <i>d<sub>A</sub></i>. Instead, Bob uses Alice’s public key <i>e<sub>A</sub></i>. In this way she obtains Alice’s signature <i>F</i>, because</p>

<div class="eq">
<p><i>M</i><sub>2</sub><sup><i>e<sub>A</sub></sup></i> ≡ (<i>F<sup>d<sub>A</sub></sup></i>)<sup><i>e<sub>A</sub></i></sup> = <i>F<sup>d<sub>A</sub>e<sub>A</sub></sup></i> ≡ <i>F</i> &emsp; (mod <i>n<sub>A</sub></i>).</p>
</div>

<p>This signature has to be authentic, as only Alice knows her private key. If what appeared were not Alice’s signature <i>F</i>, the message would have been a fake. Basically, to authenticate a signature, the sender uses her <i>private key</i>, rather than the public keys of the receiver.</p>

<section aria-label="End">
<a href="wilson.html">&#171;Primality test; Wilson's Theorem</a>
<a href="index.html">Index</a>
<a href="euclid_algorithm.html">Euclidean Algorithm &#187;</a>
</section>

</article>

</body>
</html>
